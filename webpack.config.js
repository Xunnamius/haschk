/**
* !!! DO NOT EDIT THIS FILE DIRECTLY !!!
* ! This file has been generated automatically. See the config/*.js version of
* ! this file to make permanent modifications!
*/

"use strict";

require("source-map-support/register");

var _package = _interopRequireDefault(require("./package"));

var _webpack = _interopRequireDefault(require("webpack"));

var _cleanWebpackPlugin = _interopRequireDefault(require("clean-webpack-plugin"));

var _copyWebpackPlugin = _interopRequireDefault(require("copy-webpack-plugin"));

var _htmlWebpackPlugin = _interopRequireDefault(require("html-webpack-plugin"));

var _writeFileWebpackPlugin = _interopRequireDefault(require("write-file-webpack-plugin"));

var _parseGitignore = _interopRequireDefault(require("parse-gitignore"));

var _fs = require("fs");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

require('dotenv').config();

const {
  HASHING_OUTPUT_LENGTH
} = process.env;
const paths = {};
paths.src = `${__dirname}/src`;
paths.build = `${__dirname}/build`;
paths.buildAssets = `${paths.build}/assets`;
paths.buildGitIgnore = `${paths.build}/.gitignore`;
paths.srcManifest = `${paths.src}/manifest.json`;
paths.components = `${paths.src}/components`;
paths.assets = `${paths.src}/assets`;
const assetExtensions = ['jpg', 'jpeg', 'png', `gif`, "eot", 'otf', 'svg', 'ttf', 'woff', 'woff2'];

const configure = NODE_ENV => {
  const DEV_ENV = NODE_ENV === 'development';
  const options = {};
  options.mode = DEV_ENV ? 'development' : 'production';
  options.entry = {
    background: `${paths.components}/background/index.js`,
    options: `${paths.components}/options/index.js`,
    popup: `${paths.components}/popup/index.js`
  };
  options.output = {
    path: paths.build,
    filename: '[name].packed.js'
  };
  options.module = {
    rules: [{
      test: /\.css$/,
      loader: 'style-loader!css-loader',
      exclude: /node_modules/
    }, {
      test: new RegExp(`\\.(${assetExtensions.join('|')})$`),
      loader: 'file-loader?name=[name].[ext]',
      exclude: /node_modules/
    }, {
      test: /\.html$/,
      loader: 'html-loader',
      exclude: /node_modules/
    }, {
      test: /\.js$/,
      loader: 'babel-loader?cacheDirectory',
      exclude: /node_modules/
    }]
  };
  options.plugins = [new _webpack.default.DefinePlugin({
    'process.env': {
      NODE_ENV: JSON.stringify(NODE_ENV),
      HASHING_OUTPUT_LENGTH: JSON.stringify(HASHING_OUTPUT_LENGTH)
    }
  }), new _copyWebpackPlugin.default([{
    from: paths.srcManifest,
    transform: content => Buffer.from(JSON.stringify({
      name: `${DEV_ENV ? "DEV-" : ''}${_package.default.name}`,
      description: _package.default.description,
      version: _package.default.version,
      'content_security_policy': `script-src 'self'${DEV_ENV ? " 'unsafe-eval'" : ''}; object-src 'self'`,
      ...JSON.parse(content.toString())
    }))
  }]), new _copyWebpackPlugin.default([{
    from: `${paths.assets}/icon/**/*.png`,
    to: `${paths.buildAssets}/icon/[1]`,
    test: /.*\/icon\/(.*)$/
  }]), new _htmlWebpackPlugin.default({
    template: `${paths.src}/popup.html`,
    filename: 'popup.html',
    chunks: ['popup']
  }), new _htmlWebpackPlugin.default({
    template: `${paths.src}/options.html`,
    filename: 'options.html',
    chunks: ['options']
  }), new _htmlWebpackPlugin.default({
    template: `${paths.src}/background.html`,
    filename: 'background.html',
    chunks: ['background']
  }), new _writeFileWebpackPlugin.default()];
  options.resolve = {};
  options.resolve.alias = {
    'universe': `${__dirname}/src/universe/`,
    'components': `${__dirname}/src/components/`
  };
  if (DEV_ENV) options.devtool = 'cheap-module-eval-source-map';

  if (NODE_ENV !== 'generator') {
    options.resolve.mainFields = ['browser', 'main'];
  }

  const exclude = (0, _parseGitignore.default)((0, _fs.readFileSync)(paths.buildGitIgnore)).filter(path => path.startsWith('!')).map(path => path.substr(1));
  options.plugins = [new _cleanWebpackPlugin.default([paths.build], {
    exclude
  }), ...options.plugins];
  return options;
};

module.exports = env => configure(env.NODE_ENV);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbmZpZy93ZWJwYWNrLmNvbmZpZy5qcyJdLCJuYW1lcyI6WyJyZXF1aXJlIiwiY29uZmlnIiwiSEFTSElOR19PVVRQVVRfTEVOR1RIIiwicHJvY2VzcyIsImVudiIsInBhdGhzIiwic3JjIiwiX19kaXJuYW1lIiwiYnVpbGQiLCJidWlsZEFzc2V0cyIsImJ1aWxkR2l0SWdub3JlIiwic3JjTWFuaWZlc3QiLCJjb21wb25lbnRzIiwiYXNzZXRzIiwiYXNzZXRFeHRlbnNpb25zIiwiY29uZmlndXJlIiwiTk9ERV9FTlYiLCJERVZfRU5WIiwib3B0aW9ucyIsIm1vZGUiLCJlbnRyeSIsImJhY2tncm91bmQiLCJwb3B1cCIsIm91dHB1dCIsInBhdGgiLCJmaWxlbmFtZSIsIm1vZHVsZSIsInJ1bGVzIiwidGVzdCIsImxvYWRlciIsImV4Y2x1ZGUiLCJSZWdFeHAiLCJqb2luIiwicGx1Z2lucyIsIndlYnBhY2siLCJEZWZpbmVQbHVnaW4iLCJKU09OIiwic3RyaW5naWZ5IiwiQ29weVdlYnBhY2tQbHVnaW4iLCJmcm9tIiwidHJhbnNmb3JtIiwiY29udGVudCIsIkJ1ZmZlciIsIm5hbWUiLCJwa2ciLCJkZXNjcmlwdGlvbiIsInZlcnNpb24iLCJwYXJzZSIsInRvU3RyaW5nIiwidG8iLCJIdG1sV2VicGFja1BsdWdpbiIsInRlbXBsYXRlIiwiY2h1bmtzIiwiV3JpdGVGaWxlV2VicGFja1BsdWdpbiIsInJlc29sdmUiLCJhbGlhcyIsImRldnRvb2wiLCJtYWluRmllbGRzIiwiZmlsdGVyIiwic3RhcnRzV2l0aCIsIm1hcCIsInN1YnN0ciIsIkNsZWFuV2VicGFja1BsdWdpbiIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7Ozs7QUFHQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7OztBQUVBQSxPQUFPLENBQUMsUUFBRCxDQUFQLENBQWtCQyxNQUFsQjs7QUFFQSxNQUFNO0FBQUVDLEVBQUFBO0FBQUYsSUFBNEJDLE9BQU8sQ0FB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QUcsQ0FBQ1ksUUFBTCxDQUExRCIsInNvdXJjZXNDb250ZW50IjpbIi8qIEBmbG93ICovXG5cbi8vIGZsb3ctZGlzYWJsZS1saW5lXG5pbXBvcnQgcGtnIGZyb20gJy4vcGFja2FnZSdcbmltcG9ydCB3ZWJwYWNrIGZyb20gJ3dlYnBhY2snXG5pbXBvcnQgQ2xlYW5XZWJwYWNrUGx1Z2luIGZyb20gJ2NsZWFuLXdlYnBhY2stcGx1Z2luJ1xuaW1wb3J0IENvcHlXZWJwYWNrUGx1Z2luIGZyb20gJ2NvcHktd2VicGFjay1wbHVnaW4nXG5pbXBvcnQgSHRtbFdlYnBhY2tQbHVnaW4gZnJvbSAnaHRtbC13ZWJwYWNrLXBsdWdpbidcbmltcG9ydCBXcml0ZUZpbGVXZWJwYWNrUGx1Z2luIGZyb20gJ3dyaXRlLWZpbGUtd2VicGFjay1wbHVnaW4nXG5pbXBvcnQgcGFyc2VHaXRJZ25vcmUgZnJvbSAncGFyc2UtZ2l0aWdub3JlJ1xuaW1wb3J0IHsgcmVhZEZpbGVTeW5jIH0gZnJvbSAnZnMnXG5cbnJlcXVpcmUoJ2RvdGVudicpLmNvbmZpZygpO1xuXG5jb25zdCB7IEhBU0hJTkdfT1VUUFVUX0xFTkdUSCB9ID0gcHJvY2Vzcy5lbnY7XG5cbmNvbnN0IHBhdGhzID0ge307XG5cbnBhdGhzLnNyYyA9IGAke19fZGlybmFtZX0vc3JjYDtcbnBhdGhzLmJ1aWxkID0gYCR7X19kaXJuYW1lfS9idWlsZGA7XG5wYXRocy5idWlsZEFzc2V0cyA9IGAke3BhdGhzLmJ1aWxkfS9hc3NldHNgO1xucGF0aHMuYnVpbGRHaXRJZ25vcmUgPSBgJHtwYXRocy5idWlsZH0vLmdpdGlnbm9yZWA7XG5wYXRocy5zcmNNYW5pZmVzdCA9IGAke3BhdGhzLnNyY30vbWFuaWZlc3QuanNvbmA7XG5wYXRocy5jb21wb25lbnRzID0gYCR7cGF0aHMuc3JjfS9jb21wb25lbnRzYDtcbnBhdGhzLmFzc2V0cyA9IGAke3BhdGhzLnNyY30vYXNzZXRzYDtcbmNvbnN0IGFzc2V0RXh0ZW5zaW9ucyA9IFsnanBnJywgJ2pwZWcnLCAncG5nJywgYGdpZmAsIFwiZW90XCIsICdvdGYnLCAnc3ZnJywgJ3R0ZicsICd3b2ZmJywgJ3dvZmYyJ107XG5cbmNvbnN0IGNvbmZpZ3VyZSA9IChOT0RFX0VOVjogP3N0cmluZykgPT4ge1xuICAgIGNvbnN0IERFVl9FTlYgPSBOT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JztcbiAgICBjb25zdCBvcHRpb25zID0ge307XG5cbiAgICBvcHRpb25zLm1vZGUgPSBERVZfRU5WID8gJ2RldmVsb3BtZW50JyA6ICdwcm9kdWN0aW9uJztcblxuICAgIG9wdGlvbnMuZW50cnkgPSB7XG4gICAgICAgIGJhY2tncm91bmQ6IGAke3BhdGhzLmNvbXBvbmVudHN9L2JhY2tncm91bmQvaW5kZXguanNgLFxuICAgICAgICBvcHRpb25zOiBgJHtwYXRocy5jb21wb25lbnRzfS9vcHRpb25zL2luZGV4LmpzYCxcbiAgICAgICAgcG9wdXA6IGAke3BhdGhzLmNvbXBvbmVudHN9L3BvcHVwL2luZGV4LmpzYCxcbiAgICB9O1xuXG4gICAgb3B0aW9ucy5vdXRwdXQgPSB7XG4gICAgICAgIHBhdGg6IHBhdGhzLmJ1aWxkLFxuICAgICAgICBmaWxlbmFtZTogJ1tuYW1lXS5wYWNrZWQuanMnXG4gICAgfTtcblxuICAgIG9wdGlvbnMubW9kdWxlID0ge1xuICAgICAgICBydWxlczogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRlc3Q6IC9cXC5jc3MkLyxcbiAgICAgICAgICAgICAgICBsb2FkZXI6ICdzdHlsZS1sb2FkZXIhY3NzLWxvYWRlcicsXG4gICAgICAgICAgICAgICAgZXhjbHVkZTogL25vZGVfbW9kdWxlcy9cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGVzdDogbmV3IFJlZ0V4cChgXFxcXC4oJHthc3NldEV4dGVuc2lvbnMuam9pbignfCcpfSkkYCksXG4gICAgICAgICAgICAgICAgbG9hZGVyOiAnZmlsZS1sb2FkZXI/bmFtZT1bbmFtZV0uW2V4dF0nLFxuICAgICAgICAgICAgICAgIGV4Y2x1ZGU6IC9ub2RlX21vZHVsZXMvXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRlc3Q6IC9cXC5odG1sJC8sXG4gICAgICAgICAgICAgICAgbG9hZGVyOiAnaHRtbC1sb2FkZXInLFxuICAgICAgICAgICAgICAgIGV4Y2x1ZGU6IC9ub2RlX21vZHVsZXMvXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRlc3Q6IC9cXC5qcyQvLFxuICAgICAgICAgICAgICAgIGxvYWRlcjogJ2JhYmVsLWxvYWRlcj9jYWNoZURpcmVjdG9yeScsXG4gICAgICAgICAgICAgICAgZXhjbHVkZTogL25vZGVfbW9kdWxlcy9cbiAgICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgIH07XG5cbiAgICBvcHRpb25zLnBsdWdpbnMgPSBbXG4gICAgICAgIC8vID8gQ2xlYW4gcGF0aHMuYnVpbGQgKGFkZGVkIGJlbG93IGluc3RlYWQpXG4gICAgICAgIC8vIG5ldyBDbGVhbldlYnBhY2tQbHVnaW4oWydidWlsZCddKSxcblxuICAgICAgICAvLyA/IEV4cG9zZSBkZXNpcmVkIGVudmlyb25tZW50IHZhcmlhYmxlcyBpbiB0aGUgcGFja2VkIGJ1bmRsZVxuICAgICAgICBuZXcgd2VicGFjay5EZWZpbmVQbHVnaW4oe1xuICAgICAgICAgICAgJ3Byb2Nlc3MuZW52Jzoge1xuICAgICAgICAgICAgICAgIE5PREVfRU5WOiBKU09OLnN0cmluZ2lmeShOT0RFX0VOViksXG4gICAgICAgICAgICAgICAgSEFTSElOR19PVVRQVVRfTEVOR1RIOiBKU09OLnN0cmluZ2lmeShIQVNISU5HX09VVFBVVF9MRU5HVEgpLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSksXG5cbiAgICAgICAgbmV3IENvcHlXZWJwYWNrUGx1Z2luKFt7XG4gICAgICAgICAgICBmcm9tOiBwYXRocy5zcmNNYW5pZmVzdCxcblxuICAgICAgICAgICAgLy8gPyBHZW5lcmF0ZXMgb3VyIG1hbmlmZXN0IGZpbGUgdXNpbmcgaW5mbyBmcm9tIHBhY2thZ2UuanNvblxuICAgICAgICAgICAgdHJhbnNmb3JtOiBjb250ZW50ID0+IEJ1ZmZlci5mcm9tKEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICBuYW1lOiBgJHtERVZfRU5WID8gXCJERVYtXCIgOiAnJ30ke3BrZy5uYW1lfWAsXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IHBrZy5kZXNjcmlwdGlvbixcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiBwa2cudmVyc2lvbixcbiAgICAgICAgICAgICAgICAnY29udGVudF9zZWN1cml0eV9wb2xpY3knOiBgc2NyaXB0LXNyYyAnc2VsZicke0RFVl9FTlYgPyBcIiAndW5zYWZlLWV2YWwnXCIgOiAnJ307IG9iamVjdC1zcmMgJ3NlbGYnYCxcbiAgICAgICAgICAgICAgICAuLi5KU09OLnBhcnNlKGNvbnRlbnQudG9TdHJpbmcoKSlcbiAgICAgICAgICAgIH0pKVxuICAgICAgICB9XSksXG5cbiAgICAgICAgbmV3IENvcHlXZWJwYWNrUGx1Z2luKFt7XG4gICAgICAgICAgICBmcm9tOiBgJHtwYXRocy5hc3NldHN9L2ljb24vKiovKi5wbmdgLFxuICAgICAgICAgICAgdG86IGAke3BhdGhzLmJ1aWxkQXNzZXRzfS9pY29uL1sxXWAsXG4gICAgICAgICAgICB0ZXN0OiAvLipcXC9pY29uXFwvKC4qKSQvXG4gICAgICAgIH1dKSxcblxuICAgICAgICBuZXcgSHRtbFdlYnBhY2tQbHVnaW4oe1xuICAgICAgICAgICAgdGVtcGxhdGU6IGAke3BhdGhzLnNyY30vcG9wdXAuaHRtbGAsXG4gICAgICAgICAgICBmaWxlbmFtZTogJ3BvcHVwLmh0bWwnLFxuICAgICAgICAgICAgY2h1bmtzOiBbJ3BvcHVwJ11cbiAgICAgICAgfSksXG5cbiAgICAgICAgbmV3IEh0bWxXZWJwYWNrUGx1Z2luKHtcbiAgICAgICAgICAgIHRlbXBsYXRlOiBgJHtwYXRocy5zcmN9L29wdGlvbnMuaHRtbGAsXG4gICAgICAgICAgICBmaWxlbmFtZTogJ29wdGlvbnMuaHRtbCcsXG4gICAgICAgICAgICBjaHVua3M6IFsnb3B0aW9ucyddXG4gICAgICAgIH0pLFxuXG4gICAgICAgIG5ldyBIdG1sV2VicGFja1BsdWdpbih7XG4gICAgICAgICAgICB0ZW1wbGF0ZTogYCR7cGF0aHMuc3JjfS9iYWNrZ3JvdW5kLmh0bWxgLFxuICAgICAgICAgICAgZmlsZW5hbWU6ICdiYWNrZ3JvdW5kLmh0bWwnLFxuICAgICAgICAgICAgY2h1bmtzOiBbJ2JhY2tncm91bmQnXVxuICAgICAgICB9KSxcblxuICAgICAgICBuZXcgV3JpdGVGaWxlV2VicGFja1BsdWdpbigpXG4gICAgXTtcblxuICAgIG9wdGlvbnMucmVzb2x2ZSA9IHt9O1xuXG4gICAgLy8gPyBUaGVzZSBhcmUgYWxpYXNlcyB0aGF0IGNhbiBiZSB1c2VkIGR1cmluZyBKUyBpbXBvcnQgY2FsbHNcbiAgICAvLyAhIE5vdGUgdGhhdCB5b3UgbXVzdCBhbHNvIGNoYW5nZSB0aGVzZSBzYW1lIGFsaWFzZXMgaW4gLmZsb3djb25maWdcbiAgICAvLyAhIE5vdGUgdGhhdCB5b3UgbXVzdCBhbHNvIGNoYW5nZSB0aGVzZSBzYW1lIGFsaWFzZXMgaW4gcGFja2FnZS5qc29uIChqZXN0KVxuICAgIG9wdGlvbnMucmVzb2x2ZS5hbGlhcyA9IHtcbiAgICAgICAgJ3VuaXZlcnNlJzogYCR7X19kaXJuYW1lfS9zcmMvdW5pdmVyc2UvYCxcbiAgICAgICAgJ2NvbXBvbmVudHMnOiBgJHtfX2Rpcm5hbWV9L3NyYy9jb21wb25lbnRzL2AsXG4gICAgfTtcblxuICAgIC8vID8gU2VlOiBodHRwczovL3dlYnBhY2suanMub3JnL2NvbmZpZ3VyYXRpb24vZGV2dG9vbFxuICAgIGlmKERFVl9FTlYpXG4gICAgICAgIG9wdGlvbnMuZGV2dG9vbCA9ICdjaGVhcC1tb2R1bGUtZXZhbC1zb3VyY2UtbWFwJztcblxuICAgIGlmKE5PREVfRU5WICE9PSAnZ2VuZXJhdG9yJylcbiAgICB7XG4gICAgICAgIC8vID8gU2VlOiBodHRwczovL2dpdGh1Yi5jb20vaXBmcy9qcy1pcGZzLWFwaS9wdWxsLzc3N1xuICAgICAgICBvcHRpb25zLnJlc29sdmUubWFpbkZpZWxkcyA9IFsnYnJvd3NlcicsICdtYWluJ107XG4gICAgfVxuXG4gICAgY29uc3QgZXhjbHVkZSA9IHBhcnNlR2l0SWdub3JlKHJlYWRGaWxlU3luYyhwYXRocy5idWlsZEdpdElnbm9yZSkpXG4gICAgICAgIC5maWx0ZXIocGF0aCA9PiBwYXRoLnN0YXJ0c1dpdGgoJyEnKSlcbiAgICAgICAgLm1hcChwYXRoID0+IHBhdGguc3Vic3RyKDEpKTtcblxuICAgIC8vID8gVGhlIGZvbGxvd2luZyBpcyBuZWNlc3Nhcnkgc28gQ2xlYW5XZWJwYWNrUGx1Z2luIGRvZXNuJ3Qga2lsbCBidWlsZC8uZ2l0aWdub3JlXG4gICAgb3B0aW9ucy5wbHVnaW5zID0gW1xuICAgICAgICBuZXcgQ2xlYW5XZWJwYWNrUGx1Z2luKFtwYXRocy5idWlsZF0sIHsgZXhjbHVkZSB9KSxcbiAgICAgICAgLi4ub3B0aW9ucy5wbHVnaW5zXG4gICAgXTtcblxuICAgIHJldHVybiBvcHRpb25zO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSAoZW52OiB7IE5PREVfRU5WOiA/c3RyaW5nIH0pID0+IGNvbmZpZ3VyZShlbnYuTk9ERV9FTlYpO1xuIl19