/**
* !!! DO NOT EDIT THIS FILE DIRECTLY !!!
* ! This file has been generated automatically. See the config/*.js version of
* ! this file to make permanent modifications!
*/

"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.build = exports.wpdevserv = exports.cleanBuild = exports.cleanTypes = exports.regenerate = void 0;

require("source-map-support/register");

var _fs = require("fs");

var _util = require("util");

var _gulp = _interopRequireDefault(require("gulp"));

var _gulpTap = _interopRequireDefault(require("gulp-tap"));

var _del = _interopRequireDefault(require("del"));

var _fancyLog = _interopRequireDefault(require("fancy-log"));

var _parseGitignore = _interopRequireDefault(require("parse-gitignore"));

var _core = require("@babel/core");

var _path = require("path");

var _webpack = _interopRequireDefault(require("webpack"));

var _webpackDevServer = _interopRequireDefault(require("webpack-dev-server"));

var _webpack2 = _interopRequireDefault(require("./webpack.config"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

require('dotenv').config();

const {
  WEBPACK_PORT,
  DEV_ENDPOINT
} = process.env;
if (typeof WEBPACK_PORT !== 'string') throw new TypeError('WEBPACK_PORT is improperly defined. Did you copy dist.env -> .env ?');
if (typeof DEV_ENDPOINT !== 'string') throw new TypeError('DEV_ENDPOINT is improperly defined. Did you copy dist.env -> .env ?');
const DEV_PORT = parseInt(WEBPACK_PORT, 10);
const paths = {};
paths.flowTyped = 'flow-typed';
paths.flowTypedGitIgnore = `${paths.flowTyped}/.gitignore`;
paths.build = `build`;
paths.buildGitIgnore = `${paths.build}/.gitignore`;
paths.configs = 'config';
paths.packageJson = 'package.json';
paths.launchJson = '.vscode/launch.json';
paths.launchJsonDist = '.vscode/launch.dist.json';
paths.env = '.env';
paths.envDist = 'dist.env';
paths.gitProjectDir = '.git';
paths.gitIgnore = '.gitignore';
paths.packageLockJson = 'package-lock.json';
paths.build = `${__dirname}/build`;
paths.regenTargets = [`${paths.configs}/*.js`];
const CLI_BANNER = `/**
* !!! DO NOT EDIT THIS FILE DIRECTLY !!!
* ! This file has been generated automatically. See the config/*.js version of
* ! this file to make permanent modifications!
*/\n\n`;
const readFileAsync = (0, _util.promisify)(_fs.readFile);

const cleanTypes = async () => {
  const targets = (0, _parseGitignore.default)((await readFileAsync(paths.flowTypedGitIgnore)));
  (0, _fancyLog.default)(`Deletion targets @ ${paths.flowTyped}/: "${targets.join('" "')}"`);
  (0, _del.default)(targets, {
    cwd: paths.flowTyped
  });
};

exports.cleanTypes = cleanTypes;
cleanTypes.description = `Resets the ${paths.flowTyped} directory to a pristine state`;

const cleanBuild = async () => {
  const targets = (0, _parseGitignore.default)((await readFileAsync(paths.buildGitIgnore)));
  (0, _fancyLog.default)(`Deletion targets @ ${paths.build}/: "${targets.join('" "')}"`);
  (0, _del.default)(targets, {
    cwd: paths.build
  });
};

exports.cleanBuild = cleanBuild;
cleanTypes.description = `Resets the ${paths.flowTyped} directory to a pristine state`;

const regenerate = () => {
  (0, _fancyLog.default)(`Regenerating targets: "${paths.regenTargets.join('" "')}"`);
  process.env.BABEL_ENV = 'generator';
  return _gulp.default.src(paths.regenTargets).pipe((0, _gulpTap.default)(file => file.contents = Buffer.from(CLI_BANNER + (0, _core.transformSync)(file.contents.toString(), {
    sourceFileName: (0, _path.relative)(__dirname, file.path)
  }).code))).pipe(_gulp.default.dest('.'));
};

exports.regenerate = regenerate;
regenerate.description = 'Invokes babel on the files in config, transpiling them into their project root versions';

const build = () => {
  process.env.NODE_ENV = 'production';
  return new Promise(resolve => {
    (0, _webpack.default)(_webpack2.default, (err, stats) => {
      if (err) {
        const details = err.details ? `\n\t${err.details}` : '';
        throw `WEBPACK FATAL BUILD ERROR: ${err}${details}`;
      }

      const info = stats.toJson();
      if (stats.hasErrors()) throw `WEBPACK COMPILATION ERROR: ${info.errors}`;
      if (stats.hasWarnings()) console.warn(`WEBPACK COMPILATION WARNING: ${info.warnings}`);
      resolve();
    });
  });
};

exports.build = build;
build.description = 'Yields a production-ready extension ready to be packaged';

const wpdevserv = () => {
  var _config$plugins;

  Object.keys(_webpack2.default.entry).forEach(entryKey => _webpack2.default.entry[entryKey] = [`webpack-dev-server/client?http://${DEV_ENDPOINT}:${DEV_PORT}`, 'webpack/hot/dev-server', _webpack2.default.entry[entryKey]]);
  _webpack2.default.plugins = [new _webpack.default.HotModuleReplacementPlugin(), ...((_config$plugins = _webpack2.default.plugins) !== null && _config$plugins !== void 0 ? _config$plugins : [])];
  const packer = (0, _webpack.default)(_webpack2.default);
  const server = new _webpackDevServer.default(packer, {
    hot: true,
    contentBase: paths.build,
    headers: {
      'Access-Control-Allow-Origin': '*'
    }
  });
  server.listen(DEV_PORT, err => {
    if (err) throw `WEBPACK DEV SERVER ERROR: ${err}`;
  });
};

exports.wpdevserv = wpdevserv;
wpdevserv.description = 'Launches the Webpack Development Server for testing purposes';
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbmZpZy9ndWxwZmlsZS5qcyJdLCJuYW1lcyI6WyJyZXF1aXJlIiwiY29uZmlnIiwiV0VCUEFDS19QT1JUIiwiREVWX0VORFBPSU5UIiwicHJvY2VzcyIsImVudiIsIlR5cGVFcnJvciIsIkRFVl9QT1JUIiwicGFyc2VJbnQiLCJwYXRocyIsImZsb3dUeXBlZCIsImZsb3dUeXBlZEdpdElnbm9yZSIsImJ1aWxkIiwiYnVpbGRHaXRJZ25vcmUiLCJjb25maWdzIiwicGFja2FnZUpzb24iLCJsYXVuY2hKc29uIiwibGF1bmNoSnNvbkRpc3QiLCJlbnZEaXN0IiwiZ2l0UHJvamVjdERpciIsImdpdElnbm9yZSIsInBhY2thZ2VMb2NrSnNvbiIsIl9fZGlybmFtZSIsInJlZ2VuVGFyZ2V0cyIsIkNMSV9CQU5ORVIiLCJyZWFkRmlsZUFzeW5jIiwicmVhZEZpbGUiLCJjbGVhblR5cGVzIiwidGFyZ2V0cyIsImpvaW4iLCJjd2QiLCJkZXNjcmlwdGlvbiIsImNsZWFuQnVpbGQiLCJyZWdlbmVyYXRlIiwiQkFCRUxfRU5WIiwiZ3VscCIsInNyYyIsInBpcGUiLCJmaWxlIiwiY29udGVudHMiLCJCdWZmZXIiLCJmcm9tIiwidG9TdHJpbmciLCJzb3VyY2VGaWxlTmFtZSIsInBhdGgiLCJjb2RlIiwiZGVzdCIsIk5PREVfRU5WIiwiUHJvbWlzZSIsInJlc29sdmUiLCJlcnIiLCJzdGF0cyIsImRldGFpbHMiLCJpbmZvIiwidG9Kc29uIiwiaGFzRXJyb3JzIiwiZXJyb3JzIiwiaGFzV2FybmluZ3MiLCJjb25zb2xlIiwid2FybiIsIndhcm5pbmdzIiwid3BkZXZzZXJ2IiwiT2JqZWN0Iiwia2V5cyIsImVudHJ5IiwiZm9yRWFjaCIsImVudHJ5S2V5IiwicGx1Z2lucyIsIndlYnBhY2siLCJIb3RNb2R1bGVSZXBsYWNlbWVudFBsdWdpbiIsInBhY2tlciIsInNlcnZlciIsIndlYnBhY2tEZXZTZXJ2ZXIiLCJob3QiLCJjb250ZW50QmFzZSIsImhlYWRlcnMiLCJsaXN0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QUFWLEdBQXdCLDhEQUF4QiIsInNvdXJjZXNDb250ZW50IjpbIi8qIEBmbG93ICovXG5cbi8vID8gVG8gcmVnZW5lcmF0ZSB0aGlzIGZpbGUgKGkuZS4gaWYgeW91IGNoYW5nZWQgaXQgYW5kIHdhbnQgeW91ciBjaGFuZ2VzIHRvXG4vLyA/IGJlIHBlcm1hbmVudCksIGNhbGwgYG5wbSBydW4gcmVnZW5lcmF0ZWAgYWZ0ZXJ3YXJkc1xuXG4vLyAhIEJlIHN1cmUgdGhhdCB0YXNrcyBleHBlY3RlZCB0byBydW4gb24gbnBtIGluc3RhbGwgKG1hcmtlZCBAZGVwZW5kZW50KSBoYXZlXG4vLyAhIGFsbCByZXF1aXJlZCBwYWNrYWdlcyBsaXN0ZWQgdW5kZXIgXCJkZXBlbmRlbmNpZXNcIiBpbnN0ZWFkIG9mXG4vLyAhIFwiZGV2RGVwZW5kZW5jaWVzXCIgaW4gdGhpcyBwcm9qZWN0J3MgcGFja2FnZS5qc29uXG5cbmltcG9ydCB7IHJlYWRGaWxlIH0gZnJvbSAnZnMnXG5pbXBvcnQgeyBwcm9taXNpZnkgfSBmcm9tICd1dGlsJ1xuaW1wb3J0IGd1bHAgZnJvbSAnZ3VscCdcbmltcG9ydCB0YXAgZnJvbSAnZ3VscC10YXAnXG5pbXBvcnQgZGVsIGZyb20gJ2RlbCdcbmltcG9ydCBsb2cgZnJvbSAnZmFuY3ktbG9nJ1xuaW1wb3J0IHBhcnNlR2l0SWdub3JlIGZyb20gJ3BhcnNlLWdpdGlnbm9yZSdcbmltcG9ydCB7IHRyYW5zZm9ybVN5bmMgYXMgYmFiZWwgfSBmcm9tICdAYmFiZWwvY29yZSdcbmltcG9ydCB7IHJlbGF0aXZlIGFzIHJlbFBhdGggfSBmcm9tICdwYXRoJ1xuaW1wb3J0IHdlYnBhY2sgZnJvbSAnd2VicGFjaydcbmltcG9ydCB3ZWJwYWNrRGV2U2VydmVyIGZyb20gJ3dlYnBhY2stZGV2LXNlcnZlcidcbmltcG9ydCBjb25maWcgZnJvbSAnLi93ZWJwYWNrLmNvbmZpZydcblxucmVxdWlyZSgnZG90ZW52JykuY29uZmlnKCk7XG5cbmNvbnN0IHtXRUJQQUNLX1BPUlQsIERFVl9FTkRQT0lOVH0gPSBwcm9jZXNzLmVudjtcblxuaWYodHlwZW9mIFdFQlBBQ0tfUE9SVCAhPT0gJ3N0cmluZycpXG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignV0VCUEFDS19QT1JUIGlzIGltcHJvcGVybHkgZGVmaW5lZC4gRGlkIHlvdSBjb3B5IGRpc3QuZW52IC0+IC5lbnYgPycpO1xuXG5pZih0eXBlb2YgREVWX0VORFBPSU5UICE9PSAnc3RyaW5nJylcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdERVZfRU5EUE9JTlQgaXMgaW1wcm9wZXJseSBkZWZpbmVkLiBEaWQgeW91IGNvcHkgZGlzdC5lbnYgLT4gLmVudiA/Jyk7XG5cbmNvbnN0IERFVl9QT1JUID0gcGFyc2VJbnQoV0VCUEFDS19QT1JULCAxMCk7XG5cbmNvbnN0IHBhdGhzID0ge307XG5cbnBhdGhzLmZsb3dUeXBlZCA9ICdmbG93LXR5cGVkJztcbnBhdGhzLmZsb3dUeXBlZEdpdElnbm9yZSA9IGAke3BhdGhzLmZsb3dUeXBlZH0vLmdpdGlnbm9yZWA7XG5wYXRocy5idWlsZCA9IGBidWlsZGA7XG5wYXRocy5idWlsZEdpdElnbm9yZSA9IGAke3BhdGhzLmJ1aWxkfS8uZ2l0aWdub3JlYDtcbnBhdGhzLmNvbmZpZ3MgPSAnY29uZmlnJztcbnBhdGhzLnBhY2thZ2VKc29uID0gJ3BhY2thZ2UuanNvbic7XG5wYXRocy5sYXVuY2hKc29uID0gJy52c2NvZGUvbGF1bmNoLmpzb24nO1xucGF0aHMubGF1bmNoSnNvbkRpc3QgPSAnLnZzY29kZS9sYXVuY2guZGlzdC5qc29uJztcbnBhdGhzLmVudiA9ICcuZW52JztcbnBhdGhzLmVudkRpc3QgPSAnZGlzdC5lbnYnO1xucGF0aHMuZ2l0UHJvamVjdERpciA9ICcuZ2l0JztcbnBhdGhzLmdpdElnbm9yZSA9ICcuZ2l0aWdub3JlJztcbnBhdGhzLnBhY2thZ2VMb2NrSnNvbiA9ICdwYWNrYWdlLWxvY2suanNvbic7XG5wYXRocy5idWlsZCA9IGAke19fZGlybmFtZX0vYnVpbGRgO1xuXG5wYXRocy5yZWdlblRhcmdldHMgPSBbXG4gICAgYCR7cGF0aHMuY29uZmlnc30vKi5qc2Bcbl07XG5cbmNvbnN0IENMSV9CQU5ORVIgPSBgLyoqXG4qICEhISBETyBOT1QgRURJVCBUSElTIEZJTEUgRElSRUNUTFkgISEhXG4qICEgVGhpcyBmaWxlIGhhcyBiZWVuIGdlbmVyYXRlZCBhdXRvbWF0aWNhbGx5LiBTZWUgdGhlIGNvbmZpZy8qLmpzIHZlcnNpb24gb2ZcbiogISB0aGlzIGZpbGUgdG8gbWFrZSBwZXJtYW5lbnQgbW9kaWZpY2F0aW9ucyFcbiovXFxuXFxuYDtcblxuY29uc3QgcmVhZEZpbGVBc3luYyA9IHByb21pc2lmeShyZWFkRmlsZSk7XG5cbi8vICogQ0xFQU5UWVBFU1xuXG5jb25zdCBjbGVhblR5cGVzID0gYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IHRhcmdldHMgPSBwYXJzZUdpdElnbm9yZShhd2FpdCByZWFkRmlsZUFzeW5jKHBhdGhzLmZsb3dUeXBlZEdpdElnbm9yZSkpO1xuXG4gICAgbG9nKGBEZWxldGlvbiB0YXJnZXRzIEAgJHtwYXRocy5mbG93VHlwZWR9LzogXCIke3RhcmdldHMuam9pbignXCIgXCInKX1cImApO1xuICAgIGRlbCh0YXJnZXRzLCB7Y3dkOiBwYXRocy5mbG93VHlwZWR9KTtcbn07XG5cbmNsZWFuVHlwZXMuZGVzY3JpcHRpb24gPSBgUmVzZXRzIHRoZSAke3BhdGhzLmZsb3dUeXBlZH0gZGlyZWN0b3J5IHRvIGEgcHJpc3RpbmUgc3RhdGVgO1xuXG4vLyAqIENMRUFOQlVJTERcblxuY29uc3QgY2xlYW5CdWlsZCA9IGFzeW5jICgpID0+IHtcbiAgICBjb25zdCB0YXJnZXRzID0gcGFyc2VHaXRJZ25vcmUoYXdhaXQgcmVhZEZpbGVBc3luYyhwYXRocy5idWlsZEdpdElnbm9yZSkpO1xuXG4gICAgbG9nKGBEZWxldGlvbiB0YXJnZXRzIEAgJHtwYXRocy5idWlsZH0vOiBcIiR7dGFyZ2V0cy5qb2luKCdcIiBcIicpfVwiYCk7XG4gICAgZGVsKHRhcmdldHMsIHtjd2Q6IHBhdGhzLmJ1aWxkfSk7XG59O1xuXG5jbGVhblR5cGVzLmRlc2NyaXB0aW9uID0gYFJlc2V0cyB0aGUgJHtwYXRocy5mbG93VHlwZWR9IGRpcmVjdG9yeSB0byBhIHByaXN0aW5lIHN0YXRlYDtcblxuLy8gKiBSRUdFTkVSQVRFXG5cbi8vID8gSWYgeW91IGNoYW5nZSB0aGlzIGZ1bmN0aW9uLCBydW4gYG5wbSBydW4gcmVnZW5lcmF0ZWAgdHdpY2U6IG9uY2UgdG9cbi8vID8gY29tcGlsZSB0aGlzIG5ldyBmdW5jdGlvbiBhbmQgb25jZSBhZ2FpbiB0byBjb21waWxlIGl0c2VsZiB3aXRoIHRoZSBuZXdseVxuLy8gPyBjb21waWxlZCBsb2dpYy4gSWYgdGhlcmUgaXMgYW4gZXJyb3IgdGhhdCBwcmV2ZW50cyByZWdlbmVyYXRpb24sIHlvdSBjYW5cbi8vID8gcnVuIGBucG0gcnVuIGdlbmVyYXRlYCB0aGVuIGBucG0gcnVuIHJlZ2VuZXJhdGVgIGluc3RlYWQuXG5jb25zdCByZWdlbmVyYXRlID0gKCkgPT4ge1xuICAgIGxvZyhgUmVnZW5lcmF0aW5nIHRhcmdldHM6IFwiJHtwYXRocy5yZWdlblRhcmdldHMuam9pbignXCIgXCInKX1cImApO1xuXG4gICAgcHJvY2Vzcy5lbnYuQkFCRUxfRU5WID0gJ2dlbmVyYXRvcic7XG5cbiAgICByZXR1cm4gZ3VscC5zcmMocGF0aHMucmVnZW5UYXJnZXRzKVxuICAgICAgICAucGlwZSh0YXAoZmlsZSA9PiBmaWxlLmNvbnRlbnRzID0gQnVmZmVyLmZyb20oQ0xJX0JBTk5FUiArIGJhYmVsKGZpbGUuY29udGVudHMudG9TdHJpbmcoKSwge1xuICAgICAgICAgICAgc291cmNlRmlsZU5hbWU6IHJlbFBhdGgoX19kaXJuYW1lLCBmaWxlLnBhdGgpXG4gICAgICAgIH0pLmNvZGUpKSlcbiAgICAgICAgLnBpcGUoZ3VscC5kZXN0KCcuJykpO1xufTtcblxucmVnZW5lcmF0ZS5kZXNjcmlwdGlvbiA9ICdJbnZva2VzIGJhYmVsIG9uIHRoZSBmaWxlcyBpbiBjb25maWcsIHRyYW5zcGlsaW5nIHRoZW0gaW50byB0aGVpciBwcm9qZWN0IHJvb3QgdmVyc2lvbnMnO1xuXG4vLyAqIEJVSUxEIChwcm9kdWN0aW9uKVxuXG5jb25zdCBidWlsZCA9ICgpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgICBwcm9jZXNzLmVudi5OT0RFX0VOViA9ICdwcm9kdWN0aW9uJztcbiAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgICAgIHdlYnBhY2soY29uZmlnLCAoZXJyLCBzdGF0cykgPT4ge1xuICAgICAgICAgICAgaWYoZXJyKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbnN0IGRldGFpbHMgPSBlcnIuZGV0YWlscyA/IGBcXG5cXHQke2Vyci5kZXRhaWxzfWAgOiAnJztcbiAgICAgICAgICAgICAgICB0aHJvdyBgV0VCUEFDSyBGQVRBTCBCVUlMRCBFUlJPUjogJHtlcnJ9JHtkZXRhaWxzfWA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGluZm8gPSBzdGF0cy50b0pzb24oKTtcblxuICAgICAgICAgICAgaWYoc3RhdHMuaGFzRXJyb3JzKCkpXG4gICAgICAgICAgICAgICAgdGhyb3cgYFdFQlBBQ0sgQ09NUElMQVRJT04gRVJST1I6ICR7aW5mby5lcnJvcnN9YDtcblxuICAgICAgICAgICAgaWYoc3RhdHMuaGFzV2FybmluZ3MoKSlcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFdFQlBBQ0sgQ09NUElMQVRJT04gV0FSTklORzogJHtpbmZvLndhcm5pbmdzfWApXG5cbiAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG59O1xuXG5idWlsZC5kZXNjcmlwdGlvbiA9ICdZaWVsZHMgYSBwcm9kdWN0aW9uLXJlYWR5IGV4dGVuc2lvbiByZWFkeSB0byBiZSBwYWNrYWdlZCc7XG5cbi8vICogV1BERVZTRVJWXG5cbmNvbnN0IHdwZGV2c2VydiA9ICgpID0+IHtcbiAgICBPYmplY3Qua2V5cyhjb25maWcuZW50cnkpLmZvckVhY2goZW50cnlLZXkgPT4gY29uZmlnLmVudHJ5W2VudHJ5S2V5XSA9IFtcbiAgICAgICAgYHdlYnBhY2stZGV2LXNlcnZlci9jbGllbnQ/aHR0cDovLyR7REVWX0VORFBPSU5UfToke0RFVl9QT1JUfWAsXG4gICAgICAgICd3ZWJwYWNrL2hvdC9kZXYtc2VydmVyJyxcbiAgICAgICAgY29uZmlnLmVudHJ5W2VudHJ5S2V5XVxuICAgIF0pO1xuXG4gICAgY29uZmlnLnBsdWdpbnMgPSBbXG4gICAgICAgIG5ldyB3ZWJwYWNrLkhvdE1vZHVsZVJlcGxhY2VtZW50UGx1Z2luKCksXG4gICAgICAgIC4uLihjb25maWcucGx1Z2lucyA/PyBbXSksXG4gICAgXTtcblxuICAgIGNvbnN0IHBhY2tlciA9IHdlYnBhY2soY29uZmlnKTtcbiAgICBjb25zdCBzZXJ2ZXIgPSBuZXcgd2VicGFja0RldlNlcnZlcihwYWNrZXIsIHtcbiAgICAgICAgaG90OiB0cnVlLFxuICAgICAgICBjb250ZW50QmFzZTogcGF0aHMuYnVpbGQsXG4gICAgICAgIGhlYWRlcnM6IHsgJ0FjY2Vzcy1Db250cm9sLUFsbG93LU9yaWdpbic6ICcqJyB9XG4gICAgfSk7XG5cbiAgICBzZXJ2ZXIubGlzdGVuKERFVl9QT1JULCBlcnIgPT4geyBpZihlcnIpIHRocm93IGBXRUJQQUNLIERFViBTRVJWRVIgRVJST1I6ICR7ZXJyfWAgfSk7XG59O1xuXG53cGRldnNlcnYuZGVzY3JpcHRpb24gPSAnTGF1bmNoZXMgdGhlIFdlYnBhY2sgRGV2ZWxvcG1lbnQgU2VydmVyIGZvciB0ZXN0aW5nIHB1cnBvc2VzJztcblxuZXhwb3J0IHsgcmVnZW5lcmF0ZSwgY2xlYW5UeXBlcywgY2xlYW5CdWlsZCwgd3BkZXZzZXJ2LCBidWlsZCB9O1xuIl19