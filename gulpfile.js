/**
* !!! DO NOT EDIT THIS FILE DIRECTLY !!!
* ! This file has been generated automatically. See the config/*.js version of
* ! this file to make permanent modifications!
*/

"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.build = exports.wpdevserv = exports.cleanBuild = exports.cleanTypes = exports.regenerate = void 0;

require("source-map-support/register");

var _fs = require("fs");

var _util = require("util");

var _gulp = _interopRequireDefault(require("gulp"));

var _gulpTap = _interopRequireDefault(require("gulp-tap"));

var _del = _interopRequireDefault(require("del"));

var _fancyLog = _interopRequireDefault(require("fancy-log"));

var _parseGitignore = _interopRequireDefault(require("parse-gitignore"));

var _core = require("@babel/core");

var _path = require("path");

var _webpack = _interopRequireDefault(require("webpack"));

var _webpackDevServer = _interopRequireDefault(require("webpack-dev-server"));

var _webpack2 = _interopRequireDefault(require("./webpack.config"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

require('dotenv').config();

const {
  WEBPACK_PORT
} = process.env;
if (typeof WEBPACK_PORT !== 'string') throw new TypeError('WEBPACK_PORT is improperly defined');
const DEV_PORT = parseInt(WEBPACK_PORT, 10);
const paths = {};
paths.flowTyped = 'flow-typed';
paths.flowTypedGitIgnore = `${paths.flowTyped}/.gitignore`;
paths.build = `build`;
paths.buildGitIgnore = `${paths.build}/.gitignore`;
paths.configs = 'config';
paths.packageJson = 'package.json';
paths.launchJson = '.vscode/launch.json';
paths.launchJsonDist = '.vscode/launch.dist.json';
paths.env = '.env';
paths.envDist = 'dist.env';
paths.gitProjectDir = '.git';
paths.gitIgnore = '.gitignore';
paths.packageLockJson = 'package-lock.json';
paths.build = `${__dirname}/build`;
paths.regenTargets = [`${paths.configs}/*.js`];
const CLI_BANNER = `/**
* !!! DO NOT EDIT THIS FILE DIRECTLY !!!
* ! This file has been generated automatically. See the config/*.js version of
* ! this file to make permanent modifications!
*/\n\n`;
const readFileAsync = (0, _util.promisify)(_fs.readFile);

const cleanTypes = async () => {
  const targets = (0, _parseGitignore.default)((await readFileAsync(paths.flowTypedGitIgnore)));
  (0, _fancyLog.default)(`Deletion targets @ ${paths.flowTyped}/: "${targets.join('" "')}"`);
  (0, _del.default)(targets, {
    cwd: paths.flowTyped
  });
};

exports.cleanTypes = cleanTypes;
cleanTypes.description = `Resets the ${paths.flowTyped} directory to a pristine state`;

const cleanBuild = async () => {
  const targets = (0, _parseGitignore.default)((await readFileAsync(paths.buildGitIgnore)));
  (0, _fancyLog.default)(`Deletion targets @ ${paths.buildGitIgnore}/: "${targets.join('" "')}"`);
  (0, _del.default)(targets, {
    cwd: paths.buildGitIgnore
  });
};

exports.cleanBuild = cleanBuild;
cleanTypes.description = `Resets the ${paths.flowTyped} directory to a pristine state`;

const regenerate = () => {
  (0, _fancyLog.default)(`Regenerating targets: "${paths.regenTargets.join('" "')}"`);
  process.env.BABEL_ENV = 'generator';
  return _gulp.default.src(paths.regenTargets).pipe((0, _gulpTap.default)(file => file.contents = Buffer.from(CLI_BANNER + (0, _core.transformSync)(file.contents.toString(), {
    sourceFileName: (0, _path.relative)(__dirname, file.path)
  }).code))).pipe(_gulp.default.dest('.'));
};

exports.regenerate = regenerate;
regenerate.description = 'Invokes babel on the files in config, transpiling them into their project root versions';

const build = () => {
  process.env.NODE_ENV = 'production';
  return (0, _webpack.default)(_webpack2.default, err => {
    if (err) throw `WEBPACK BUILD ERROR: ${err}`;
  });
};

exports.build = build;
build.description = 'Yields a production-ready extension ready to be packaged';

const wpdevserv = () => {
  var _config$plugins;

  Object.keys(_webpack2.default.entry).forEach(entryKey => _webpack2.default.entry[entryKey] = [`webpack-dev-server/client?http://0.0.0.0:${DEV_PORT}`, 'webpack/hot/dev-server', _webpack2.default.entry[entryKey]]);
  _webpack2.default.plugins = [new _webpack.default.HotModuleReplacementPlugin(), ...((_config$plugins = _webpack2.default.plugins) !== null && _config$plugins !== void 0 ? _config$plugins : [])];
  const packer = (0, _webpack.default)(_webpack2.default);
  const server = new _webpackDevServer.default(packer, {
    hot: true,
    contentBase: paths.build,
    headers: {
      'Access-Control-Allow-Origin': '*'
    }
  });
  server.listen(DEV_PORT);
};

exports.wpdevserv = wpdevserv;
wpdevserv.description = 'Launches the Webpack Development Server for testing purposes';
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbmZpZy9ndWxwZmlsZS5qcyJdLCJuYW1lcyI6WyJyZXF1aXJlIiwiY29uZmlnIiwiV0VCUEFDS19QT1JUIiwicHJvY2VzcyIsImVudiIsIlR5cGVFcnJvciIsIkRFVl9QT1JUIiwicGFyc2VJbnQiLCJwYXRocyIsImZsb3dUeXBlZCIsImZsb3dUeXBlZEdpdElnbm9yZSIsImJ1aWxkIiwiYnVpbGRHaXRJZ25vcmUiLCJjb25maWdzIiwicGFja2FnZUpzb24iLCJsYXVuY2hKc29uIiwibGF1bmNoSnNvbkRpc3QiLCJlbnZEaXN0IiwiZ2l0UHJvamVjdERpciIsImdpdElnbm9yZSIsInBhY2thZ2VMb2NrSnNvbiIsIl9fZGlybmFtZSIsInJlZ2VuVGFyZ2V0cyIsIkNMSV9CQU5ORVIiLCJyZWFkRmlsZUFzeW5jIiwicmVhZEZpbGUiLCJjbGVhblR5cGVzIiwidGFyZ2V0cyIsImpvaW4iLCJjd2QiLCJkZXNjcmlwdGlvbiIsImNsZWFuQnVpbGQiLCJyZWdlbmVyYXRlIiwiQkFCRUxfRU5WIiwiZ3VscCIsInNyYyIsInBpcGUiLCJmaWxlIiwiY29udGVudHMiLCJCdWZmZXIiLCJmcm9tIiwidG9TdHJpbmciLCJzb3VyY2VGaWxlTmFtZSIsInBhdGgiLCJjb2RlIiwiZGVzdCIsIk5PREVfRU5WIiwiZXJyIiwid3BkZXZzZXJ2IiwiT2JqZWN0Iiwia2V5cyIsImVudHJ5IiwiZm9yRWFjaCIsImVudHJ5S2V5IiwicGx1Z2lucyIsIndlYnBhY2siLCJIb3RNb2R1bGVSZXBsYWNlbWVudFBsdWdpbiIsInBhY2tlciIsInNlcnZlciIsIndlYnBhY2tEZXZTZXJ2ZXIiLCJob3QiLCJjb250ZW50QmFzZSIsImhlYWRlcnMiLCJsaXN0ZW4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQVNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOzs7O0FBRUFBLE9BQU8sQ0FBQyxRQUFELENBQVAsQ0FBa0JD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QUN4Q0csSUFBQUEsR0FBRyxFQUFFLElBRG1DO0FBRXhDQyxJQUFBQSxXQUFXLEVBQUVyRCxLQUFLLENBQUNHLEtBRnFCO0FBR3hDbUQsSUFBQUEsT0FBTyxFQUFFO0FBQUUscUNBQStCO0FBQWpDO0FBSCtCLEdBQTdCLENBQWY7QUFNQUosRUFBQUEsTUFBTSxDQUFDSyxNQUFQLENBQWN6RCxRQUFkO0FBQ0gsQ0FwQkQ7OztBQXNCQTBDLFNBQVMsQ0FBQ2xCLFdBQVYsR0FBd0IsOERBQXhCIiwic291cmNlc0NvbnRlbnQiOlsiLyogQGZsb3cgKi9cblxuLy8gPyBUbyByZWdlbmVyYXRlIHRoaXMgZmlsZSAoaS5lLiBpZiB5b3UgY2hhbmdlZCBpdCBhbmQgd2FudCB5b3VyIGNoYW5nZXMgdG9cbi8vID8gYmUgcGVybWFuZW50KSwgY2FsbCBgbnBtIHJ1biByZWdlbmVyYXRlYCBhZnRlcndhcmRzXG5cbi8vICEgQmUgc3VyZSB0aGF0IHRhc2tzIGV4cGVjdGVkIHRvIHJ1biBvbiBucG0gaW5zdGFsbCAobWFya2VkIEBkZXBlbmRlbnQpIGhhdmVcbi8vICEgYWxsIHJlcXVpcmVkIHBhY2thZ2VzIGxpc3RlZCB1bmRlciBcImRlcGVuZGVuY2llc1wiIGluc3RlYWQgb2Zcbi8vICEgXCJkZXZEZXBlbmRlbmNpZXNcIiBpbiB0aGlzIHByb2plY3QncyBwYWNrYWdlLmpzb25cblxuaW1wb3J0IHsgcmVhZEZpbGUgfSBmcm9tICdmcydcbmltcG9ydCB7IHByb21pc2lmeSB9IGZyb20gJ3V0aWwnXG5pbXBvcnQgZ3VscCBmcm9tICdndWxwJ1xuaW1wb3J0IHRhcCBmcm9tICdndWxwLXRhcCdcbmltcG9ydCBkZWwgZnJvbSAnZGVsJ1xuaW1wb3J0IGxvZyBmcm9tICdmYW5jeS1sb2cnXG5pbXBvcnQgcGFyc2VHaXRJZ25vcmUgZnJvbSAncGFyc2UtZ2l0aWdub3JlJ1xuaW1wb3J0IHsgdHJhbnNmb3JtU3luYyBhcyBiYWJlbCB9IGZyb20gJ0BiYWJlbC9jb3JlJ1xuaW1wb3J0IHsgcmVsYXRpdmUgYXMgcmVsUGF0aCB9IGZyb20gJ3BhdGgnXG5pbXBvcnQgd2VicGFjayBmcm9tICd3ZWJwYWNrJ1xuaW1wb3J0IHdlYnBhY2tEZXZTZXJ2ZXIgZnJvbSAnd2VicGFjay1kZXYtc2VydmVyJ1xuaW1wb3J0IGNvbmZpZyBmcm9tICcuL3dlYnBhY2suY29uZmlnJ1xuXG5yZXF1aXJlKCdkb3RlbnYnKS5jb25maWcoKTtcblxuY29uc3QgeyBXRUJQQUNLX1BPUlQgfSA9IHByb2Nlc3MuZW52O1xuXG5pZih0eXBlb2YgV0VCUEFDS19QT1JUICE9PSAnc3RyaW5nJylcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdXRUJQQUNLX1BPUlQgaXMgaW1wcm9wZXJseSBkZWZpbmVkJyk7XG5cbmNvbnN0IERFVl9QT1JUID0gcGFyc2VJbnQoV0VCUEFDS19QT1JULCAxMCk7XG5cbmNvbnN0IHBhdGhzID0ge307XG5cbnBhdGhzLmZsb3dUeXBlZCA9ICdmbG93LXR5cGVkJztcbnBhdGhzLmZsb3dUeXBlZEdpdElnbm9yZSA9IGAke3BhdGhzLmZsb3dUeXBlZH0vLmdpdGlnbm9yZWA7XG5wYXRocy5idWlsZCA9IGBidWlsZGA7XG5wYXRocy5idWlsZEdpdElnbm9yZSA9IGAke3BhdGhzLmJ1aWxkfS8uZ2l0aWdub3JlYDtcbnBhdGhzLmNvbmZpZ3MgPSAnY29uZmlnJztcbnBhdGhzLnBhY2thZ2VKc29uID0gJ3BhY2thZ2UuanNvbic7XG5wYXRocy5sYXVuY2hKc29uID0gJy52c2NvZGUvbGF1bmNoLmpzb24nO1xucGF0aHMubGF1bmNoSnNvbkRpc3QgPSAnLnZzY29kZS9sYXVuY2guZGlzdC5qc29uJztcbnBhdGhzLmVudiA9ICcuZW52JztcbnBhdGhzLmVudkRpc3QgPSAnZGlzdC5lbnYnO1xucGF0aHMuZ2l0UHJvamVjdERpciA9ICcuZ2l0JztcbnBhdGhzLmdpdElnbm9yZSA9ICcuZ2l0aWdub3JlJztcbnBhdGhzLnBhY2thZ2VMb2NrSnNvbiA9ICdwYWNrYWdlLWxvY2suanNvbic7XG5wYXRocy5idWlsZCA9IGAke19fZGlybmFtZX0vYnVpbGRgO1xuXG5wYXRocy5yZWdlblRhcmdldHMgPSBbXG4gICAgYCR7cGF0aHMuY29uZmlnc30vKi5qc2Bcbl07XG5cbmNvbnN0IENMSV9CQU5ORVIgPSBgLyoqXG4qICEhISBETyBOT1QgRURJVCBUSElTIEZJTEUgRElSRUNUTFkgISEhXG4qICEgVGhpcyBmaWxlIGhhcyBiZWVuIGdlbmVyYXRlZCBhdXRvbWF0aWNhbGx5LiBTZWUgdGhlIGNvbmZpZy8qLmpzIHZlcnNpb24gb2ZcbiogISB0aGlzIGZpbGUgdG8gbWFrZSBwZXJtYW5lbnQgbW9kaWZpY2F0aW9ucyFcbiovXFxuXFxuYDtcblxuY29uc3QgcmVhZEZpbGVBc3luYyA9IHByb21pc2lmeShyZWFkRmlsZSk7XG5cbi8vICogQ0xFQU5UWVBFU1xuXG5jb25zdCBjbGVhblR5cGVzID0gYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IHRhcmdldHMgPSBwYXJzZUdpdElnbm9yZShhd2FpdCByZWFkRmlsZUFzeW5jKHBhdGhzLmZsb3dUeXBlZEdpdElnbm9yZSkpO1xuXG4gICAgbG9nKGBEZWxldGlvbiB0YXJnZXRzIEAgJHtwYXRocy5mbG93VHlwZWR9LzogXCIke3RhcmdldHMuam9pbignXCIgXCInKX1cImApO1xuICAgIGRlbCh0YXJnZXRzLCB7IGN3ZDogcGF0aHMuZmxvd1R5cGVkIH0pO1xufTtcblxuY2xlYW5UeXBlcy5kZXNjcmlwdGlvbiA9IGBSZXNldHMgdGhlICR7cGF0aHMuZmxvd1R5cGVkfSBkaXJlY3RvcnkgdG8gYSBwcmlzdGluZSBzdGF0ZWA7XG5cbi8vICogQ0xFQU5CVUlMRFxuXG5jb25zdCBjbGVhbkJ1aWxkID0gYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IHRhcmdldHMgPSBwYXJzZUdpdElnbm9yZShhd2FpdCByZWFkRmlsZUFzeW5jKHBhdGhzLmJ1aWxkR2l0SWdub3JlKSk7XG5cbiAgICBsb2coYERlbGV0aW9uIHRhcmdldHMgQCAke3BhdGhzLmJ1aWxkR2l0SWdub3JlfS86IFwiJHt0YXJnZXRzLmpvaW4oJ1wiIFwiJyl9XCJgKTtcbiAgICBkZWwodGFyZ2V0cywgeyBjd2Q6IHBhdGhzLmJ1aWxkR2l0SWdub3JlIH0pO1xufTtcblxuY2xlYW5UeXBlcy5kZXNjcmlwdGlvbiA9IGBSZXNldHMgdGhlICR7cGF0aHMuZmxvd1R5cGVkfSBkaXJlY3RvcnkgdG8gYSBwcmlzdGluZSBzdGF0ZWA7XG5cbi8vICogUkVHRU5FUkFURVxuXG4vLyA/IElmIHlvdSBjaGFuZ2UgdGhpcyBmdW5jdGlvbiwgcnVuIGBucG0gcnVuIHJlZ2VuZXJhdGVgIHR3aWNlOiBvbmNlIHRvXG4vLyA/IGNvbXBpbGUgdGhpcyBuZXcgZnVuY3Rpb24gYW5kIG9uY2UgYWdhaW4gdG8gY29tcGlsZSBpdHNlbGYgd2l0aCB0aGUgbmV3bHlcbi8vID8gY29tcGlsZWQgbG9naWMuIElmIHRoZXJlIGlzIGFuIGVycm9yIHRoYXQgcHJldmVudHMgcmVnZW5lcmF0aW9uLCB5b3UgY2FuXG4vLyA/IHJ1biBgbnBtIHJ1biBnZW5lcmF0ZWAgdGhlbiBgbnBtIHJ1biByZWdlbmVyYXRlYCBpbnN0ZWFkLlxuY29uc3QgcmVnZW5lcmF0ZSA9ICgpID0+IHtcbiAgICBsb2coYFJlZ2VuZXJhdGluZyB0YXJnZXRzOiBcIiR7cGF0aHMucmVnZW5UYXJnZXRzLmpvaW4oJ1wiIFwiJyl9XCJgKTtcblxuICAgIHByb2Nlc3MuZW52LkJBQkVMX0VOViA9ICdnZW5lcmF0b3InO1xuXG4gICAgcmV0dXJuIGd1bHAuc3JjKHBhdGhzLnJlZ2VuVGFyZ2V0cylcbiAgICAgICAgICAgICAgIC5waXBlKHRhcChmaWxlID0+IGZpbGUuY29udGVudHMgPSBCdWZmZXIuZnJvbShDTElfQkFOTkVSICsgYmFiZWwoZmlsZS5jb250ZW50cy50b1N0cmluZygpLCB7XG4gICAgICAgICAgICAgICAgICAgc291cmNlRmlsZU5hbWU6IHJlbFBhdGgoX19kaXJuYW1lLCBmaWxlLnBhdGgpXG4gICAgICAgICAgICAgICB9KS5jb2RlKSkpXG4gICAgICAgICAgICAgICAucGlwZShndWxwLmRlc3QoJy4nKSk7XG59O1xuXG5yZWdlbmVyYXRlLmRlc2NyaXB0aW9uID0gJ0ludm9rZXMgYmFiZWwgb24gdGhlIGZpbGVzIGluIGNvbmZpZywgdHJhbnNwaWxpbmcgdGhlbSBpbnRvIHRoZWlyIHByb2plY3Qgcm9vdCB2ZXJzaW9ucyc7XG5cbi8vICogQlVJTEQgKHByb2R1Y3Rpb24pXG5cbmNvbnN0IGJ1aWxkID0gKCkgPT4ge1xuICAgIHByb2Nlc3MuZW52Lk5PREVfRU5WID0gJ3Byb2R1Y3Rpb24nO1xuICAgIHJldHVybiB3ZWJwYWNrKGNvbmZpZywgZXJyID0+IHsgaWYoZXJyKSB0aHJvdyBgV0VCUEFDSyBCVUlMRCBFUlJPUjogJHtlcnJ9YCB9KTtcbn07XG5cbmJ1aWxkLmRlc2NyaXB0aW9uID0gJ1lpZWxkcyBhIHByb2R1Y3Rpb24tcmVhZHkgZXh0ZW5zaW9uIHJlYWR5IHRvIGJlIHBhY2thZ2VkJztcblxuLy8gKiBXUERFVlNFUlZcblxuY29uc3Qgd3BkZXZzZXJ2ID0gKCkgPT4ge1xuICAgIE9iamVjdC5rZXlzKGNvbmZpZy5lbnRyeSkuZm9yRWFjaChlbnRyeUtleSA9PiBjb25maWcuZW50cnlbZW50cnlLZXldID0gW1xuICAgICAgICBgd2VicGFjay1kZXYtc2VydmVyL2NsaWVudD9odHRwOi8vMC4wLjAuMDoke0RFVl9QT1JUfWAsXG4gICAgICAgICd3ZWJwYWNrL2hvdC9kZXYtc2VydmVyJyxcbiAgICAgICAgY29uZmlnLmVudHJ5W2VudHJ5S2V5XVxuICAgIF0pO1xuXG4gICAgY29uZmlnLnBsdWdpbnMgPSBbXG4gICAgICAgIG5ldyB3ZWJwYWNrLkhvdE1vZHVsZVJlcGxhY2VtZW50UGx1Z2luKCksXG4gICAgICAgIC4uLihjb25maWcucGx1Z2lucyA/PyBbXSlcbiAgICBdO1xuXG4gICAgY29uc3QgcGFja2VyID0gd2VicGFjayhjb25maWcpO1xuICAgIGNvbnN0IHNlcnZlciA9IG5ldyB3ZWJwYWNrRGV2U2VydmVyKHBhY2tlciwge1xuICAgICAgICBob3Q6IHRydWUsXG4gICAgICAgIGNvbnRlbnRCYXNlOiBwYXRocy5idWlsZCxcbiAgICAgICAgaGVhZGVyczogeyAnQWNjZXNzLUNvbnRyb2wtQWxsb3ctT3JpZ2luJzogJyonIH1cbiAgICB9KTtcblxuICAgIHNlcnZlci5saXN0ZW4oREVWX1BPUlQpO1xufTtcblxud3BkZXZzZXJ2LmRlc2NyaXB0aW9uID0gJ0xhdW5jaGVzIHRoZSBXZWJwYWNrIERldmVsb3BtZW50IFNlcnZlciBmb3IgdGVzdGluZyBwdXJwb3Nlcyc7XG5cbmV4cG9ydCB7IHJlZ2VuZXJhdGUsIGNsZWFuVHlwZXMsIGNsZWFuQnVpbGQsIHdwZGV2c2VydiwgYnVpbGQgfTtcbiJdfQ==